---
permalink: /controls-html/ISM-1671.html
title: "Microsoft Office macros are disabled for users that do not have a demonstrated business requirement. (ISM-1671)"
ism_control: "ISM-1671"
revision: "0"
updated: "Sep-21"
guideline: "Guidelines for system hardening"
section: "User application hardening"
topic: "Microsoft Office macros"
essential_eight:
  - "ML1"
  - "ML2"
  - "ML3"
pspf_levels:
  - "NC"
  - "OS"
  - "P"
  - "S"
  - "TS"
date_generated: "2025-12-25"
---
# Microsoft Office macros are disabled for users that do not have a demonstrated business requirement. (ISM-1671)

| Property | Value |
|----------|-------|
| **ISM Control** | ISM-1671 |
| **Revision** | 0 |
| **Updated** | Sep-21 |
| **Guideline** | Guidelines for system hardening |
| **Section** | User application hardening |
| **Topic** | Microsoft Office macros |
| **Essential Eight** | ML1, ML2, ML3 |
| **PSPF Levels** | NC, OS, P, S, TS |

## Summary

Microsoft Office macros are disabled by default for users without a demonstrated business requirement.[^1] Intune-based deployment disables macros for all Office users and enforces an exception path for approved users by placing them in a dedicated group (Allow macro execution - Trusted Publisher) and applying an All Macros Disabled policy.[^1] The approach aligns with ACSC hardening guidance, which includes blocking macros from running in Office files from the Internet and enforcing signing requirements for macros via Trusted Publishers.[^1]

[^1]:Essential Eight configure Microsoft Office macro settings - Essential Eight | Microsoft Learn(https://learn.microsoft.com/en-us/compliance/anz/e8-macro)

## Design Decision

> [!NOTE] Disable all Microsoft Office macros via Intune by default; create an exempt group for users with an approved business need and apply an exception-based macro execution policy to that group.

## Prerequisites

* **Licensing:** Not provided in source documentation.
* **Permissions/Roles:** Not provided in source documentation.
* **Dependencies:** Access to Microsoft Intune to create/import/assign policies; ACSC Office Hardening Guidelines policy file (ACSC Office Hardening Guidelines.json) to import; Office macro hardening PowerShell script (OfficeMacroHardening-PreventActivationofOLE.ps1) to deploy; Policy files All Macros Disabled.json and Macros Enabled for Trusted Publishers.json to import; Groups All Office Users and Allow macro execution - Trusted Publisher for policy assignments; ASR policy deployment via Graph API (including authentication with Graph Explorer) and the ASR JSON policy content; Windows Defender running on devices (required for Defender runtime features); Defender for Endpoint integration with Intune for logging macro activity; Optional use of the Microsoft 365 Apps security baseline in Intune (Baseline Version 2306) for related Office macro security settings. [^1][^2]

[^1]:Essential Eight configure Microsoft Office macro settings - Essential Eight | Microsoft Learn (https://learn.microsoft.com/en-us/compliance/anz/e8-macro)
[^2]:List of settings for the Microsoft 365 Apps for Enterprise security baseline in Intune - Microsoft Intune | Microsoft Learn (https://learn.microsoft.com/en-us/intune/intune-service/protect/security-baseline-v2-office-settings)

## Implementation Steps

### Disable all macros via Intune except for approved users

1. Create a group that contains users that are able to run Office macros if they're signed by a Trusted Publisher. This group is referred to as: Allow macro execution - Trusted Publisher.[^1]

2. Save the All Macros Disabled policy to your local device. Policy file: [All Macros Disabled.json](https://github.com/microsoft/Intune-ACSC-Windows-Hardening-Guidelines/blob/main/office/policies/All%20Macros%20Disabled.json).[^1]

3. Open the Microsoft Intune console. Navigate to Devices > Windows > Configuration profiles > Create > Import Policy. (Proceed to import the policy saved in step 2.)[^1]

4. Name the policy, select Policy file, and browse to the saved policy from step 2. Click Save.[^1]

5. Assign the All Macros Disabled policy to All Office Users (the group created at the start of this section).[^1]

6. Exclude the Allow macro execution - Trusted Publisher group (from step 1) from this policy to block macros by default for all others.[^1]

7. Save and apply the policy set. The default state blocks macros for all Office users except those in the approved group.[^1]

8. Validate that the blocked macros policy is applied to All Office Users and that the Allow macro execution - Trusted Publisher group is exempted.[^1]

### Macros Enabled for Trusted Publishers

1. Save the Macros Enabled for Trusted Publishers policy to your local device. Policy file: [Macros Enabled for Trusted Publishers.json](https://github.com/microsoft/Intune-ACSC-Windows-Hardening-Guidelines/blob/main/office/policies/Macros%20Enabled%20for%20Trusted%20Publishers.json).[^1]

2. Navigate to the Microsoft Intune console. Import a policy under Devices > Windows > Configuration profiles > Create > Import Policy. (Browse to the saved policy from step 1.)[^1]

3. Name the policy, select Policy file, and browse to the saved policy from step 1. Click Save.[^1]

4. Assign the Macros Enabled for Trusted Publishers policy to the group: Allow macro execution - Trusted Publisher. This permits macros signed by approved publishers for this group.[^1]

5. Create a new policy for each Trusted Publisher. For each publisher, repeat steps 2–4 to import a separate policy that permits only that publisher’s macros. Assign each policy to the Allow macro execution - Trusted Publisher group.[^1]

6. After importing the Trusted Publisher policies, specify one or more Trusted Publishers by importing their certificates into the Trusted Publishers certificate store as guided by Intune documentation. The following reference provides steps for adding a certificate to Trusted Publishers: [Intune: Adding a Certificate to Trusted Publishers using Intune - Microsoft Tech Community](https://techcommunity.microsoft.com/t5/intune-customer-success/adding-a-certificate-to-trusted-publishers-using-microsoft/ba-p/1974488#:%7E:text=To%20add%20a%20certificate%20to%20the%20Trusted%20Publishers,a%20new%2C%20custom%20Windows%2010%20device%20configuration%20profile).[^1]

7. Assign each Macros Enabled for Trusted Publishers policy to the group: Allow macro execution - Trusted Publisher. This ensures only macros from trusted publishers execute for the approved group. If multiple publishers exist, manage their certificates and separate policies accordingly.[^1]

8. Exclude the Allow macro execution - Trusted Publisher group from the All Macros Disabled policy to ensure approved macros can run for trusted publishers. This prevents conflicts between the disabled-by-default policy and trusted-publisher exceptions.[^1]

9. Note: When signing macros, use the more secure V3 signature scheme. This strengthens the trust chain for publisher-signed macros.[^1]

10. By allowing macros only from Trusted Publishers, the following mitigations are supported:

- Macro execution is restricted to digitally signed macros from trusted publishers.  
- Administrative oversight of trusted publishers is maintained via per-publisher policies.  
- End-user changes to macro policies are minimized by policy-based enforcement.  
[^1]

[^1]:Essential Eight configure Microsoft Office macro settings(https://learn.microsoft.com/en-us/compliance/anz/e8-macro)