<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Credential Guard functionality is enabled. - ISM Controls Guide</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #0d1117;
      min-height: 100vh;
      color: #e6edf3;
      text-align: left;
    }
    .header {
      background: #161b22;
      border-bottom: 1px solid #30363d;
      padding: 15px 40px;
      
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .back-btn {
      background: #21262d; border: 1px solid #30363d;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      border-color: #58a6ff;
    }
    .header-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #e6edf3;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px 20px;
    }
    .content-card {
      background: #161b22;
      border-radius: 6px; border: 1px solid #30363d;
      padding: 40px;
      
      text-align: left;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: 700;
      color: #e6edf3;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #30363d;
    }
    h2 {
      font-size: 1.4rem;
      font-weight: 600;
      color: #e6edf3;
      margin-top: 30px;
      margin-bottom: 15px;
    }
    h3 {
      font-size: 1.2rem;
      font-weight: 600;
      color: #8b949e;
      margin-top: 25px;
      margin-bottom: 12px;
    }
    p { line-height: 1.7; margin-bottom: 15px; color: #8b949e; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 0.95rem;
    }
    th, td {
      padding: 12px 15px;
      border: 1px solid #30363d;
      text-align: left;
    }
    th {
      background: #21262d; border: 1px solid #30363d;
      color: white;
      font-weight: 600;
    }
    tr:nth-child(even) { background: #161b22; } tr:nth-child(odd) { background: #0d1117; }
    ul, ol { margin: 15px 0; padding-left: 25px; }
    li { margin-bottom: 8px; line-height: 1.6; }
    a { color: #58a6ff; text-decoration: none; font-weight: 500; }
    a:hover { text-decoration: underline; }
    code {
      background: #21262d;
      padding: 3px 8px;
      border-radius: 4px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
    }
    pre {
      background: #161b22;
      color: #e6edf3;
      padding: 20px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 20px 0;
    }
    pre code { background: none; padding: 0; color: inherit; }
    blockquote {
      border-left: 4px solid #58a6ff;
      padding: 15px 20px;
      margin: 20px 0;
      background: rgba(88, 166, 255, 0.1);
      border-radius: 0 8px 8px 0;
    }
    blockquote p { margin: 0; }
    hr { border: none; border-top: 1px solid #30363d; margin: 30px 0; }
    @media (max-width: 768px) {
      .header { padding: 15px 20px; flex-direction: column; align-items: flex-start; gap: 10px; }
      .content-card { padding: 25px; }
      h1 { font-size: 1.5rem; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="header">
    <a href="../" class="back-btn">← Back to Controls</a>
    <span class="header-title">Credential Guard functionality is enabled.</span>
  </div>
  <div class="container">
    <div class="content-card" id="content">
    </div>
  </div>
  <script>
    const markdown = `---
title: "Credential Guard functionality is enabled. (ISM-1686)"
ism_control: "ISM-1686"
revision: "1"
updated: "Dec-23"
guideline: "Guidelines for system hardening"
section: "Authentication hardening"
topic: "Protecting credentials"
essential_eight:
  - "ML3"
pspf_levels:
  - "NC"
  - "OS"
  - "P"
  - "S"
  - "TS"
date_generated: "2025-12-25"
---
| Property | Value |
|----------|-------|
| **ISM Control** | ISM-1686 |
| **Revision** | 1 |
| **Updated** | Dec-23 |
| **Guideline** | Guidelines for system hardening |
| **Section** | Authentication hardening |
| **Topic** | Protecting credentials |
| **Essential Eight** | ML3 |
| **PSPF Levels** | NC, OS, P, S, TS |

## Summary

Credential Guard is enabled on devices that meet hardware requirements and can be configured via an Intune device configuration profile[^1]. Use a Settings Catalog policy under Device Guard to enable Credential Guard with either “Enabled with UEFI lock” or “Enabled without lock,” assign the policy to the target devices, and restart the device to apply the changes[^1]. Verification is done via System Information or PowerShell (Event Viewer can also be used); do not rely on checking the LsaIso.exe process in Task Manager[^1].

[^1]:Configure Credential Guard(Microsoft Learn)(https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure)

## Design Decision

> [!NOTE] Enable Credential Guard via an Intune device configuration profile to implement Credential Guard as required by ISM-1686.

## Prerequisites

* **Licensing:** Not provided in source documentation. [^1]
* **Permissions/Roles:** Not provided in source documentation. [^1]
* **Dependencies:** Device must be Intune-managed to apply Credential Guard via Intune; hardware must support Secure Boot and Direct Memory Access (DMA) protections; virtualization-based security (VBS) features must be available; Credential Guard must be enabled before domain join or before first sign-in; the device must be restarted after applying the policy. [^1]

[^1]:Configure Credential Guard | Microsoft Learn(https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure)

## Implementation Steps

### Enable Credential Guard via Intune

1. In Microsoft Intune, create a Settings Catalog policy.[^1]

2. In the Settings Catalog, configure the following two settings:

   - Setting name: Turn On Virtualization Based Security  
     OMA-URI: \`./Device/Vendor/MSFT/Policy/Config/DeviceGuard/EnableVirtualizationBasedSecurity\`  
     Data type: int  
     Value: 1

   - Setting name: Credential Guard Configuration  
     OMA-URI: \`./Device/Vendor/MSFT/Policy/Config/DeviceGuard/LsaCfgFlags\`  
     Data type: int  
     Value:  
     - Enabled with UEFI lock: 1  
     - Enabled without lock: 2

   Note: If you want to be able to turn off Credential Guard remotely, choose the option **Enabled without lock**.[^1]

3. Assign the policy to a group that contains the devices or users you want to configure.[^1]

4. Once the policy is applied, restart the device.[^1]

5. Verify Credential Guard is enabled:

   - System Information method:

     1. Start, type msinfo32.exe, and open System Information.
     2. Select System Summary.
     3. Confirm Credential Guard is shown next to Virtualization-based Security Services Running.[^1]

   - PowerShell method:

     \`\`\`
     (Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\Microsoft\Windows\DeviceGuard).SecurityServicesRunning
     \`\`\`

     The command returns 0 for disabled and 1 for enabled.[^1]

   - Event Viewer method:

     Open Event Viewer, go to Windows Logs > System, and filter for events related to Credential Guard. Look for entries such as:
     
     - Credential Guard (LsaIso.exe) was started and will protect LSA credentials.
     - Credential Guard (LsaIso.exe) configuration: [0x0  | 0x1 | 0x2], 0
     - Credential Guard (LsaIso.exe) is configured but the secure kernel isn't running; continuing without Credential Guard.
     - Credential Guard (LsaIso.exe) failed to launch: [error code]
     - Error reading Credential Guard (LsaIso.exe) UEFI configuration: [error code]

     Any of these indicate the Credential Guard state.[^1]

Not provided in source documentation.`;
    const contentWithoutFrontmatter = markdown.replace(/^---[\s\S]*?---\s*/m, '');
    document.getElementById('content').innerHTML = marked.parse(contentWithoutFrontmatter);
  </script>
</body>
</html>
