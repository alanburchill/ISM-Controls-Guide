<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Microsoft Office macros are blocked from making Win32 API calls. (ISM-1673) - ISM Controls Guide</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
      text-align: left;
    }
    .header {
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      padding: 15px 40px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .back-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    .header-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #1a1a2e;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px 20px;
    }
    .content-card {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      text-align: left;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 3px solid #667eea;
    }
    h2 {
      font-size: 1.4rem;
      font-weight: 600;
      color: #333;
      margin-top: 30px;
      margin-bottom: 15px;
    }
    h3 {
      font-size: 1.2rem;
      font-weight: 600;
      color: #444;
      margin-top: 25px;
      margin-bottom: 12px;
    }
    p { line-height: 1.7; margin-bottom: 15px; color: #444; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 0.95rem;
    }
    th, td {
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
      text-align: left;
    }
    th {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      font-weight: 600;
    }
    tr:nth-child(even) { background: #f8f9fa; }
    ul, ol { margin: 15px 0; padding-left: 25px; }
    li { margin-bottom: 8px; line-height: 1.6; }
    a { color: #667eea; text-decoration: none; font-weight: 500; }
    a:hover { text-decoration: underline; }
    code {
      background: #f1f3f4;
      padding: 3px 8px;
      border-radius: 4px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
    }
    pre {
      background: #1a1a2e;
      color: #e0e0e0;
      padding: 20px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 20px 0;
    }
    pre code { background: none; padding: 0; color: inherit; }
    blockquote {
      border-left: 4px solid #667eea;
      padding: 15px 20px;
      margin: 20px 0;
      background: #f8f9ff;
      border-radius: 0 8px 8px 0;
    }
    blockquote p { margin: 0; }
    hr { border: none; border-top: 2px solid #e0e0e0; margin: 30px 0; }
    @media (max-width: 768px) {
      .header { padding: 15px 20px; flex-direction: column; align-items: flex-start; gap: 10px; }
      .content-card { padding: 25px; }
      h1 { font-size: 1.5rem; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="header">
    <a href="../" class="back-btn">‚Üê Back to Controls</a>
    <span class="header-title">Microsoft Office macros are blocked from making Win32 API calls. (ISM-1673)</span>
  </div>
  <div class="container">
    <div class="content-card" id="content">
    </div>
  </div>
  <script>
    const markdown = `---
title: "Microsoft Office macros are blocked from making Win32 API calls. (ISM-1673)"
ism_control: "ISM-1673"
revision: "0"
updated: "Sep-21"
guideline: "Guidelines for system hardening"
section: "User application hardening"
topic: "Microsoft Office macros"
essential_eight:
  - "ML2"
  - "ML3"
pspf_levels:
  - "NC"
  - "OS"
  - "P"
  - "S"
  - "TS"
date_generated: "2025-12-25"
---
# Microsoft Office macros are blocked from making Win32 API calls. (ISM-1673)

| Property | Value |
|----------|-------|
| **ISM Control** | ISM-1673 |
| **Revision** | 0 |
| **Updated** | Sep-21 |
| **Guideline** | Guidelines for system hardening |
| **Section** | User application hardening |
| **Topic** | Microsoft Office macros |
| **Essential Eight** | ML2, ML3 |
| **PSPF Levels** | NC, OS, P, S, TS |

## Summary

Block Win32 API calls from Office macros using the ASR rule.[^1] Implement this by configuring Attack Surface Reduction in Intune and enabling the rule to Block.[^1] The rule supports Block, Audit, and Warn modes, with Not configured as the default.[^1]

[^1]:[Intune endpoint security Attack surface reduction settings - Microsoft Intune](https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-asr-profile-settings)

## Design Decision

> [!NOTE] Enable the Attack Surface Reduction rule to block Win32 API calls from Office macros via Intune. This design decision implements the guidance to prevent Office macros from invoking Win32 APIs, reducing macro-based attack surfaces.

## Prerequisites

* **Licensing:** Enterprise license is required to use the full ASR feature set; a limited number of rules may work without an enterprise license. [^2]
* **Permissions/Roles:** Not provided in source documentation.
* **Dependencies:** 
  1) Microsoft Defender Antivirus must be set as the primary antivirus and must not be in passive mode or disabled. [^2]
  2) Real-time protection must be on. [^2]
  3) Cloud-Delivery Protection must be on. [^2]
  4) You must have Cloud Protection network connectivity. [^2]
  5) Recommended: Microsoft 365 E5. [^2]

[^2]:Enable attack surface reduction rules - Microsoft Defender for Endpoint (https://learn.microsoft.com/en-us/defender-endpoint/enable-attack-surface-reduction)

## Implementation Steps

### Intune

1. Open Endpoint Security > Attack surface reduction. Choose an existing attack surface reduction policy or create a new one. To create a new one, select Create Policy and enter information for this profile. For Profile type, select Attack surface reduction rules. If you've chosen an existing profile, select Properties and then select Settings.[^1]

2. In the Configuration settings pane, select Attack Surface Reduction and then select the desired setting for Block Win32 API calls from Office macro. This enables the ASR rule to block Office macros from making Win32 API calls.[^1]

3. Under List of additional folders that need to be protected, List of apps that have access to protected folders, and Exclude files and paths from attack surface reduction rules, enter individual files and folders. You can also select Import to import a CSV file that contains files and folders to exclude from attack surface reduction rules. Each line in the CSV file should be formatted as follows:

\`C:\folder\`, \`%ProgramFiles%\folder\file\`, \`C:\path\`[^1]

4. Select Next on the three configuration panes, then select Create if you're creating a new policy or Save if you're editing an existing policy.[^1]

> [!NOTE] In the latest Intune interface, Configuration profiles is located under Devices > Configuration profiles.[^1]

[^1]:Intune endpoint security Attack surface reduction settings - Microsoft Intune(https://learn.microsoft.com/en-us/intune/intune-service/protect/endpoint-security-asr-profile-settings)`;
    const contentWithoutFrontmatter = markdown.replace(/^---[\s\S]*?---\s*/m, '');
    document.getElementById('content').innerHTML = marked.parse(contentWithoutFrontmatter);
  </script>
</body>
</html>
